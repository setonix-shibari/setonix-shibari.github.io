---
title: "Image Creation Scripts"
execute: 
  eval: false
---

```{r}
library(webmorphR)
wm_opts(fill = "black")
```

## Logo

```{r}
stim <- read_stim("../../s/emo-grid/", "happy")

add_logo <- function(stim, 
                     logo_color = "white", 
                     logo_rotate = 0,
                     logo_size = height(stim)/20,
                     logo_offset = height(stim)*.015,
                     gravity = "northwest",
                     pad = 0) {

  logo <- read_stim("../../s/logo/setonix-name.png") |> 
    rep(length(stim)) |>
    image_func("colorize", opacity = 100, color = logo_color) |>
    resize(height = logo_size) |>
    rotate(logo_rotate, fill = "#00000000", keep_size = FALSE)
  
  offset <- sprintf("+%d+%d", round(logo_offset), round(logo_offset))
  
  stim |> 
    image_func("composite", 
               composite_image = webmorphR:::get_imgs(logo),
               offset = offset,
               gravity = gravity) |>
    pad(pad, fill = logo_color)
}


logo_stim <- add_logo(stim, "goldenrod", -90, pad = .01) |>
  resize(height = 1000)

logo_stim
```



## HOT TO GO

```{r}
chappel_colours <- rep(
  c("#6E4787", "#EBA73F", "#EF86C8"
), times = c(3, 2, 2))

# redorange = "#771E15", 
# blue = "#173F75",,
# yellow = "#EBA73F" , 
# pink = "#EF86C8",
# purple = "#6E4787"

orig <- read_stim("../../s/hottogo/") |>
  resize(height = 1000) |>
  crop(height = 750, y_off = 100)
```


### Wide  

```{r}
border_fix <- rep(c(3/4, 1), times = c(3, 4))

borders <- orig |>
  pad(50 * border_fix, fill = chappel_colours)# |>
 # image_func("colorize", opacity = 10, color = chappel_colours)


hottogo <- plot_rows(borders[1:3], borders[4:7])
write_stim(hottogo, 
           "../www/images/hottogo/", 
           "hottogo-wide", 
           format = "jpg", 
           overwrite = TRUE)
```

![](../www/images/hottogo/hottogo-wide.jpg)


### Long

```{r}
border_fix <- rep(c(1, 2/3), times = c(3, 4))

borders <- orig |>
  pad(50 * border_fix, fill = chappel_colours)

hottogo <- plot_rows(borders[1:3], borders[4:5], borders[6:7])

write_stim(hottogo, 
           "../www/images/composites/", 
           "hottogo-long", 
           format = "jpg", 
           overwrite = TRUE)
```



![](../www/images/composites/hottogo-long.jpg)
### Animated

```{r}
borders <- orig |>
  pad(50, fill = chappel_colours)

# 140 bpm is 2.333 beats per second
hottogo <- animate(borders, fps = 2.5)

write_stim(hottogo, 
           "../www/images/composites/", 
           "hottogo", 
           format = "gif", 
           overwrite = TRUE)
```


![](../www/images/composites/hottogo.gif)

## Emo Grid

```{r}
emos <- c("anger", "surprise", "happy", "disgust", "sad", "fear")
emo_colours <- c("firebrick4", "darkorange4", "goldenrod", 
                 "darkgreen", "dodgerblue4", "darkorchid4") |>
  sapply(color_conv, to = "hex")

emo_imgs <- list()

for (i in 1:6) {
  emo_imgs[[emos[i]]] <- read_stim("../../s/emo-grid/", emos[i]) |>
    resize(height = 1000) |>
    image_func("colorize", 
               opacity = 10, 
               color = emo_colours[i]) |>
    pad(20, fill = emo_colours[i])
}
```

### Logo

```{r}
for (i in 1:6) {
  emo_imgs[[emos[i]]] |>
    resize(height = 1000) |>
    add_logo(emo_colours[i], 0, logo_offset = 30, pad = 5) |>
    write_stim("../www/images/ties/", 
               format = "jpg", 
               overwrite = TRUE)
}
```


### All 3

```{r}
emo_all <- do.call(c, emo_imgs) |>
  plot_stim(nrow = 3, byrow = FALSE)

write_stim(emo_all, 
           "../www/images/composites/", 
           "emo-grid", 
           format = "jpg", 
           overwrite = TRUE)
```

![](../www/images/composites/emo-grid.jpg)

### Ekman 6

```{r}
emo_6 <- c(emo_imgs$anger[[3]],
           emo_imgs$surprise[[1]],
           emo_imgs$happy[[2]],
           emo_imgs$disgust[[1]],
           emo_imgs$sad[[3]],
           emo_imgs$fear[[3]])

plot_stim(emo_6, nrow = 2, 
          padding = 25, 
          external_pad = FALSE) |>
  write_stim("../www/images/composites/", 
             "emo-6", 
             format = "jpg", 
             overwrite = TRUE)
```

![](../www/images/composites/emo-6.jpg)

### Animation

```{r}
emo_6 |>
  resize(height = 400) |>
  animate(fps = 1) |>
  write_stim("../www/images/gifs/", "emo_6", format = "gif")
```

![](../www/images/gifs/emo_6.gif)

### Back

```{r}
back <- read_stim("../../s/emo-grid/back/")|>
    resize(height = 1000) |>
    image_func("colorize", 
               opacity = 10, 
               color = emo_colours) |>
    pad(20, fill = emo_colours)

back_grid <- plot_stim(back, 
                       nrow = 2, 
                       padding = 25, 
                       external_pad = FALSE)

write_stim(back_grid, 
           "../www/images/composites/", 
           "emo-back", 
           format = "jpg", 
           overwrite = TRUE)
```

![](../www/images/composites/emo-back.jpg)
